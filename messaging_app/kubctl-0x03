#!/bin/bash

# Script: kubctl-0x03
# Purpose: Apply rolling update and monitor for downtime

echo "ğŸš€ Applying updated blue deployment with image version 2.0..."
kubectl apply -f blue_deployment.yaml

echo "â³ Monitoring rollout status..."
kubectl rollout status deployment/django-blue

echo "ğŸ” Sending continuous requests to test for downtime..."
for i in {1..10}; do
  curl -s http://localhost:8000/api/ || echo "âŒ Request failed"
  sleep 2
done

echo "ğŸ“¦ Verifying current pods..."
kubectl get pods -l app=messaging

echo "âœ… Rolling update complete."
